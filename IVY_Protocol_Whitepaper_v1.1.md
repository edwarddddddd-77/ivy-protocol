# IVY Protocol 技术白皮书

**Version 1.1**

**January 2026**

**修订说明：v1.0 → v1.1**
- 修正代币分配方案 (15% Pre-mint + 70% Mining + 15% LP Reserve)
- 修正推荐奖励系统 (Breakaway 算法)
- 更新 Genesis Node 供应量 (1,386 - 1,727)
- 新增 LP Reserve 四阶段分配详情
- 新增附录 A 核心参数参考

---

## 目录

1. [执行摘要](#1-执行摘要)
2. [市场背景](#2-市场背景)
3. [产品架构](#3-产品架构)
4. [代币经济学](#4-代币经济学)
5. [收益机制](#5-收益机制)
6. [推荐奖励系统](#6-推荐奖励系统)
7. [DAO 治理](#7-dao-治理)
8. [智能合约架构](#8-智能合约架构)
9. [风险控制](#9-风险控制)
10. [技术实现](#10-技术实现)
11. [路线图](#11-路线图)
12. [法律声明](#12-法律声明)
13. [附录](#13-附录)

---

## 1. 执行摘要

### 1.1 项目愿景

IVY Protocol 是一个基于 PID 控制器的结构化债券 DeFi 协议，旨在为用户提供稳定、透明、可持续的链上收益解决方案。通过创新的资金分配机制和动态调节系统，IVY Protocol 实现了传统金融结构化产品与去中心化金融的深度融合。

### 1.2 核心价值主张

- **结构化安全**：采用 50/40/10 三层资金分配模型，将用户资金分散至挖矿、RWA 资产和储备金，有效降低单一风险敞口
- **动态平衡**：基于 PID 控制器的代币释放机制，根据市场状况自动调节产出，维护生态系统长期稳定
- **NFT 化资产**：用户持仓以 Bond NFT 形式存在，具备可转让性、可组合性，为 DeFi 乐高提供基础设施
- **社区驱动**：Genesis Node 持有者享有 DAO 治理权，协议发展由社区共同决定

### 1.3 关键数据

| 指标 | 数值 |
|------|------|
| 初始日释放量 | 30,000 IVY |
| 硬顶总量 | 100,000,000 IVY |
| Genesis Node 价格 | 1,000 USDT |
| Genesis Node 总量 | 1,386 - 1,727 个 |
| 最低存款金额 | 10 USDT |

---

## 2. 市场背景

### 2.1 DeFi 结构化产品现状

去中心化金融经过多年发展，已从简单的借贷、交易演变为复杂的金融生态系统。然而，当前 DeFi 市场仍面临以下挑战：

1. **收益波动剧烈**：传统流动性挖矿 APY 大起大落，用户难以预期实际收益
2. **机制不透明**：部分协议的代币释放和资金流向缺乏清晰说明
3. **可持续性存疑**：高收益往往依赖通胀补贴，长期价值堪忧
4. **风险集中**：资金池单点故障可能导致全部资产损失

IVY Protocol 通过结构化分层设计，为上述问题提供系统性解决方案。

### 2.2 RWA 赛道分析

真实世界资产 (Real World Assets, RWA) 代币化是 2024-2026 年 DeFi 领域最重要的发展方向之一。据行业预测，到 2030 年 RWA 市场规模将超过 16 万亿美元。

IVY Protocol 将 40% 的用户存款配置于 RWA 资产（如国债、货币市场基金等），实现：
- 链上收益与链下资产的有机结合
- 降低纯加密资产的波动风险
- 为用户提供更稳定的价值锚定

### 2.3 目标用户画像

**主要用户群体：**

| 用户类型 | 特征 | 需求 |
|----------|------|------|
| DeFi 投资者 | 熟悉链上操作，追求资产增值 | 稳定收益、透明机制 |
| 稳健型投资者 | 风险偏好较低，注重本金安全 | 结构化保护、RWA 支撑 |
| 社区推广者 | 拥有社交影响力，善于推广 | 推荐奖励、团队收益 |
| DAO 参与者 | 关注协议治理，愿意长期持有 | 投票权、决策参与 |

---

## 3. 产品架构

### 3.1 核心机制概述

IVY Protocol 的核心运作流程如下：

```
用户存入 USDT
      ↓
  铸造 Bond NFT
      ↓
┌─────────────────────────────────────┐
│     资金自动分配 (50/40/10)          │
├───────────┬───────────┬─────────────┤
│  50% 挖矿  │  40% RWA  │  10% 储备   │
│  Tranche B │ Tranche A │  Tranche C  │
└───────────┴───────────┴─────────────┘
      ↓
  产生 vIVY (挖矿产出)
      ↓
  Harvest 转换为锁仓 IVY
      ↓
  30天线性释放 或 即时提取(50%罚没)
```

### 3.2 资金分配模型 (50/40/10)

IVY Protocol 采用三层结构化资金分配模型，每笔存款自动按比例分配：

#### Tranche B - 挖矿本金 (50%)

- **用途**：作为用户的挖矿算力基数
- **特点**：
  - 直接决定 IVY 挖矿产出
  - 与 Genesis Node 加成叠加计算
  - 复投时享受额外 10% 算力加成
- **计算公式**：
  ```
  基础算力 = 存款金额 × 50%
  有效算力 = 基础算力 × (1 + Genesis Node 加成)
  ```

#### Tranche A - RWA 资产 (40%)

- **用途**：配置于真实世界资产，提供稳定价值支撑
- **资产类型**：
  - 美国国债 (T-Bills)
  - 货币市场基金
  - 其他低风险固定收益产品
- **特点**：
  - 由专业托管机构管理
  - 定期公布持仓报告
  - 收益回流至协议储备

#### Tranche C - 协议储备金 (10%)

- **用途**：协议风险准备金和运营资金
- **功能**：
  - 应对极端市场情况
  - 支付协议运营成本
  - 回购销毁 IVY（通缩机制）

### 3.3 Bond NFT 系统

用户存款后获得的 Bond NFT 是 ERC-721 标准代币，代表用户在协议中的持仓权益。

**Bond NFT 属性：**

| 属性 | 说明 |
|------|------|
| tokenId | 唯一标识符 |
| depositAmount | 原始存款金额 (USDT) |
| miningPower | 挖矿算力 (含复投加成) |
| mintTime | 铸造时间戳 |
| referrer | 推荐人地址 |

**Bond NFT 特性：**

1. **可转让性**：Bond NFT 可在二级市场自由交易
2. **可组合性**：支持复投增强算力，多个 Bond 算力累加
3. **收益绑定**：挖矿收益与 Bond NFT 持有者地址关联
4. **链上透明**：所有持仓数据链上可查

### 3.4 Genesis Node NFT 系统

Genesis Node 是 IVY Protocol 的核心会员权益凭证，采用弹性供应机制。

**基本信息：**

| 参数 | 数值 |
|------|------|
| 价格 | 1,000 USDT |
| 初始供应量 | 1,386 个 (暂定) |
| 硬顶上限 | 1,727 个 |
| 标准 | ERC-721 |

*注：最终供应量将在 1,386 - 1,727 范围内，由市场需求和 DAO 治理决定。*

**持有者权益：**

1. **自身挖矿加成 (Self Boost)**
   - 持有 Genesis Node 可获得 +10% 挖矿算力加成
   - 加成仅作用于存款产生的算力，不作用于复投算力

2. **团队光环 (Team Aura)**
   - 直推用户自动获得 +2% 额外算力加成
   - 无需直推用户持有 Genesis Node

3. **DAO 投票权**
   - 1 个 Genesis Node = 1 票
   - 参与协议重大决策投票

4. **身份标识**
   - Genesis Node 持有者在前端显示特殊标识
   - 享有社区优先权益

**加成计算示例：**

```
用户 A 持有 Genesis Node，存款 10,000 USDT
用户 B 由 A 直推，存款 5,000 USDT

用户 A 算力计算：
  基础算力 = 10,000 × 50% = 5,000
  Self Boost = 5,000 × 10% = 500
  有效算力 = 5,500

用户 B 算力计算：
  基础算力 = 5,000 × 50% = 2,500
  Team Aura = 2,500 × 2% = 50
  有效算力 = 2,550
```

---

## 4. 代币经济学

### 4.1 IVY 代币概述

IVY 是 IVY Protocol 的原生治理与收益代币，部署于 BNB Smart Chain (BSC)。

**代币信息：**

| 参数 | 数值 |
|------|------|
| 代币名称 | IVY Token |
| 代币符号 | IVY |
| 代币标准 | BEP-20 |
| 总供应量 | 100,000,000 IVY |
| 小数位数 | 18 |

### 4.2 代币分配方案

**总供应量：100,000,000 IVY (100M)**

| 分配类别 | 数量 | 占比 | 释放方式 |
|----------|------|------|----------|
| **Pre-mint 预铸** | 15,000,000 | 15% | 部署时一次性铸造 |
| └─ DAO Treasury | 5,000,000 | 5% | DAO 金库储备 |
| └─ Initial Liquidity | 5,000,000 | 5% | 初始流动性池 |
| └─ Operations | 5,000,000 | 5% | 运营资金 |
| **Mining 挖矿** | 70,000,000 | 70% | PID 控制器动态释放 |
| **LP Reserve 配对池** | 15,000,000 | 15% | 四阶段渐进式释放 |

**校验：** 15M + 70M + 15M = 100M ✓

#### LP Reserve 四阶段渐进式分配 (Progressive Hybrid LP Strategy)

LP Reserve 采用渐进式混合策略，随着储备消耗逐步从"铸造"过渡到"市场购买"：

| 阶段 | 储备使用量 | 储备铸造 | 市场购买 | 阶段名称 |
|------|------------|----------|----------|----------|
| Stage 1 | 0 - 5M | 80% | 20% | Foundation 基础期 |
| Stage 2 | 5M - 10M | 50% | 50% | Acceleration 加速期 |
| Stage 3 | 10M - 15M | 20% | 80% | Sprint 冲刺期 |
| Stage 4 | > 15M | 0% | 100% | Mature 成熟期 |

**设计目的：**
- **Stage 1-3**：通过储备铸造降低早期用户的滑点成本
- **Stage 4**：储备耗尽后，完全依赖市场购买，形成买压支撑价格
- **渐进过渡**：避免模式切换时的市场冲击

### 4.3 释放机制与通缩模型

**释放机制：**

IVY 代币通过挖矿产出进入流通，初始日释放量为 30,000 IVY，由 PID 控制器根据市场状况动态调节。

**通缩机制：**

1. **即时提取罚没**：用户选择即时提取时，50% 的 IVY 被销毁
2. **复投销毁**：复投操作将 IVY 发送至黑洞地址 (0xdead)
3. **协议回购**：储备金定期用于市场回购并销毁

**通缩公式：**
```
实际流通量 = 总释放量 - 即时提取销毁量 - 复投销毁量 - 回购销毁量
```

### 4.4 PID 控制器动态调节

IVY Protocol 采用 PID (比例-积分-微分) 控制器算法，根据协议健康指标动态调节代币释放速率。

**控制变量：**

| 变量 | 权重 | 目标 |
|------|------|------|
| IVY 价格偏离 | 40% | 维持价格稳定 |
| 总锁仓量变化 | 30% | 鼓励长期持仓 |
| 流通量占比 | 30% | 控制通胀速度 |

**调节公式：**
```
释放乘数 = 1 + Kp × 价格偏离 + Ki × 累积偏离 + Kd × 偏离变化率

其中：
Kp = 比例系数
Ki = 积分系数
Kd = 微分系数

实际日释放量 = 基础释放量 × 释放乘数 × 排放因子
```

**调节范围：**
- 最小乘数：0.5x（市场过热时减半释放）
- 最大乘数：2.0x（市场低迷时加倍释放）

### 4.5 价格稳定机制

IVY Protocol 通过多重机制维护 IVY 代币价格稳定：

1. **动态释放调节**：价格上涨时减少释放，价格下跌时增加释放
2. **30天锁仓期**：延缓抛压，平滑市场波动
3. **复投激励**：10% 额外算力加成鼓励用户复投而非抛售
4. **储备金回购**：协议收入用于市场回购支撑价格

---

## 5. 收益机制

### 5.1 挖矿算力计算

用户的挖矿收益与其有效算力占全网算力的比例成正比。

**算力计算公式：**

```
有效算力 = 存款算力 × (1 + Genesis Boost) + 复投算力

其中：
存款算力 = 存款金额 × 50%
复投算力 = 复投 IVY 数量 × IVY 价格 × 110%
Genesis Boost = Self Boost + Team Aura (如适用)
```

**收益计算公式：**

```
用户日收益 = 日释放总量 × (用户有效算力 / 全网总算力)
```

**示例：**
```
假设：
- 日释放量 = 30,000 IVY
- 全网总算力 = 1,000,000
- 用户有效算力 = 10,000

用户日收益 = 30,000 × (10,000 / 1,000,000) = 300 IVY
```

### 5.2 vIVY → IVY 转换流程

挖矿产出的代币首先以 vIVY (virtual IVY) 形式存在，需要通过 Harvest 操作转换为可提取的 IVY。

**转换流程：**

```
挖矿产出 vIVY (实时累积)
         ↓
    Harvest 操作
         ↓
  转换为锁仓 IVY
         ↓
   进入30天释放周期
         ↓
  线性释放可提取 IVY
```

**vIVY 特性：**
- 实时累积，每秒计算
- 不可转让
- Harvest 前可选择部分或全部转换
- Harvest 后重置 vIVY 余额

### 5.3 30天线性释放机制

Harvest 后的 IVY 进入 30 天线性释放周期，每天释放 1/30。

**释放公式：**
```
可领取金额 = 锁仓总量 × min(已过天数 / 30, 1)
```

**示例：**
```
用户 Harvest 300 IVY，进入锁仓

第 1 天可领取：300 × (1/30) = 10 IVY
第 15 天可领取：300 × (15/30) = 150 IVY
第 30 天可领取：300 × (30/30) = 300 IVY (全部)
```

**设计目的：**
- 降低短期抛压
- 鼓励长期持有
- 平滑市场波动

### 5.4 即时提取与罚没机制

用户可选择即时提取锁仓中的 IVY，但需承担 50% 罚没。

**即时提取规则：**
```
实际获得 = 锁仓金额 × 50%
销毁金额 = 锁仓金额 × 50%
```

**示例：**
```
用户锁仓 300 IVY，选择即时提取

实际获得：300 × 50% = 150 IVY
销毁数量：300 × 50% = 150 IVY (发送至 0xdead)
```

**设计目的：**
- 为急需流动性的用户提供退出选项
- 罚没部分进入通缩销毁，利好长期持有者
- 平衡流动性需求与生态稳定性

### 5.5 复投加成 (Compound Bonus)

用户可将 vIVY 直接复投至 Bond NFT，享受 10% 额外算力加成。

**复投流程：**
```
vIVY (待领取)
      ↓
  选择复投
      ↓
  IVY 销毁至 0xdead
      ↓
  查询 IVY 价格 (Oracle)
      ↓
  计算算力：IVY数量 × 价格 × 110%
      ↓
  增加至 Bond NFT 算力
```

**复投优势：**

| 对比项 | 直接提取 | 复投 |
|--------|----------|------|
| 等待时间 | 30天释放 | 即时生效 |
| 算力转换 | 无 | 110% 算力 |
| 抛压影响 | 增加 | 无 (销毁) |
| 收益复利 | 无 | 有 |

**复投示例：**
```
用户有 100 vIVY，IVY 价格 = 1 USDT

选择复投：
  销毁 100 IVY
  获得算力 = 100 × 1 × 110% = 110 Power

对比直接提取后再存款：
  获得算力 = 100 × 50% = 50 Power

复投收益：110 / 50 = 2.2 倍
```

---

## 6. 推荐奖励系统

### 6.1 Breakaway 算法概述

IVY Protocol 采用 Breakaway 算法进行推荐奖励分配，该算法具有以下特点：

- **四层奖励结构**：L1 直推、L2 间推、Team Bonus、Peer Bonus
- **节点断点机制**：遇到 Genesis Node 持有者时停止向上搜索
- **Gas 保护**：最大搜索深度 20 层，防止 Gas 耗尽攻击

**奖励比例总览：**

| 奖励类型 | 比例 | 获得者 |
|----------|------|--------|
| L1 直推 | 10% | 直接推荐人 |
| L2 间推 | 5% | 推荐人的推荐人 |
| Team Bonus | 2% | 向上搜索遇到的第一个 Genesis Node 持有者 |
| Peer Bonus | 0.5% | Team Leader 的直接上级（需也持有 Genesis Node） |

### 6.2 L1/L2 基础推荐奖励

**L1 直推奖励 (10%)**
- 触发条件：被推荐用户产生挖矿收益
- 获得者：直接推荐人
- 计算方式：被推荐用户收益 × 10%

**L2 间推奖励 (5%)**
- 触发条件：被推荐用户产生挖矿收益
- 获得者：推荐人的推荐人
- 计算方式：被推荐用户收益 × 5%

**示例：**
```
A 推荐 B，B 推荐 C

当 C 获得 100 IVY 挖矿收益时：
B 获得：100 × 10% = 10 IVY (L1 直推)
A 获得：100 × 5% = 5 IVY (L2 间推)
```

### 6.3 Team Bonus (团队奖励)

Team Bonus 是 Breakaway 算法的核心机制，奖励给推荐链中最近的 Genesis Node 持有者。

**工作原理：**
```
用户 D 产生收益
    ↓
从 D 的 L1 开始向上搜索
    ↓
检查每一级是否持有 Genesis Node
    ↓
找到第一个持有者 → 支付 2% Team Bonus
    ↓
停止搜索 (Breakaway)
```

**示例：**
```
推荐链：A → B → C → D → E

假设只有 B 持有 Genesis Node

当 E 获得 100 IVY 收益时：
D 获得：10 IVY (L1 - 10%)
C 获得：5 IVY (L2 - 5%)
B 获得：2 IVY (Team Bonus - 2%)  ← Genesis Node 持有者
A 获得：0 (被 B 断点，无法继续获得)
```

**设计目的：**
- 激励用户购买 Genesis Node 获取团队收益
- 防止奖励无限向上传递
- 保护 Gas 消耗在可控范围

### 6.4 Peer Bonus (平级奖励)

当 Team Leader（捕获 Team Bonus 的人）的直接上级也持有 Genesis Node 时，该上级获得 Peer Bonus。

**规则：**
- 奖励比例：0.5%
- 触发条件：Team Leader 的直接上级也是 Genesis Node 持有者
- 目的：奖励培养出优秀团队领导的上级

**示例：**
```
推荐链：A → B → C → D → E

假设 A 和 B 都持有 Genesis Node

当 E 获得 100 IVY 收益时：
D 获得：10 IVY (L1)
C 获得：5 IVY (L2)
B 获得：2 IVY (Team Bonus) ← 第一个 Genesis Node 持有者
A 获得：0.5 IVY (Peer Bonus) ← B 的上级，也持有 Genesis Node
```

### 6.5 反作弊机制

为防止刷单和自我推荐等作弊行为，IVY Protocol 实施以下措施：

1. **地址关联检测**
   - 分析链上交互模式
   - 识别关联钱包地址
   - 异常行为自动标记

2. **最低持仓要求**
   - 领取推荐奖励需持有有效 Bond NFT
   - 奖励发放与自身业绩挂钩

3. **冷却期机制**
   - 新用户推荐奖励 7 天后开始计算
   - 防止快进快出套利

4. **社区监督**
   - DAO 可提案冻结可疑账户
   - 严重违规者永久取消奖励资格

---

## 7. DAO 治理

### 7.1 治理架构

IVY Protocol 采用去中心化自治组织 (DAO) 模式进行协议治理，Genesis Node 持有者为核心治理成员。

**治理原则：**
- 透明公开：所有提案和投票链上可查
- 社区驱动：重大决策由持有者投票决定
- 渐进去中心化：逐步将更多权限移交 DAO

**治理范围：**
- 协议参数调整（费率、释放量等）
- 新功能开发优先级
- 生态合作伙伴准入
- 储备金使用方案
- 紧急情况处理

### 7.2 提案类型与流程

**提案类型：**

| 类型 | 说明 | 通过门槛 |
|------|------|----------|
| 参数变更 | 调整协议参数 | 60% |
| 功能请求 | 新增或修改功能 | 55% |
| 合作提案 | 生态合作事项 | 55% |
| 社区活动 | 营销推广活动 | 50% |
| 紧急提案 | 应对突发情况 | 70% |

**提案流程：**

```
1. 提案创建
   ↓ (需持有 Genesis Node)
2. 社区讨论期 (3天)
   ↓
3. 正式投票期 (7天)
   ↓
4. 投票结果公示
   ↓
5. 执行或否决
```

### 7.3 投票权重 (1 Node = 1 Vote)

**投票规则：**
- 每个 Genesis Node = 1 票投票权
- 单个地址可持有多个 Node，票数累加
- 投票期间 Node 不可转让（防止重复投票）

**最低参与要求：**
- 有效提案需达到法定人数
- 法定人数 = Genesis Node 总数的 25%（约 347 - 432 票）
- 未达法定人数的提案自动作废

### 7.4 执行机制

**链上执行：**
- 参数变更类提案通过后自动执行
- 智能合约内置时间锁（24小时延迟执行）
- 紧急提案可跳过时间锁（需 70% 以上支持）

**链下执行：**
- 功能开发、合作等提案由核心团队执行
- 定期向 DAO 汇报执行进度
- 社区可提案监督执行情况

---

## 8. 智能合约架构

### 8.1 合约模块设计

IVY Protocol 采用模块化合约设计，主要包含以下核心合约：

```
┌─────────────────────────────────────────────────────────┐
│                    IVY Protocol 合约架构                 │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐ │
│  │   IvyCore   │    │   IvyBond   │    │  IvyToken   │ │
│  │  核心挖矿    │◄──►│  Bond NFT   │◄──►│  IVY代币    │ │
│  └──────┬──────┘    └──────┬──────┘    └─────────────┘ │
│         │                  │                            │
│         ▼                  ▼                            │
│  ┌─────────────┐    ┌─────────────┐                    │
│  │ GenesisNode │    │  Treasury   │                    │
│  │  节点NFT    │    │   资金池     │                    │
│  └─────────────┘    └─────────────┘                    │
│                                                         │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐ │
│  │  Referral   │    │    DAO      │    │   Oracle    │ │
│  │  推荐系统    │    │   治理      │    │  价格预言   │ │
│  └─────────────┘    └─────────────┘    └─────────────┘ │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**核心合约说明：**

| 合约 | 功能 |
|------|------|
| IvyCore | 核心挖矿逻辑、收益计算、Harvest、Compound |
| IvyBond | Bond NFT 铸造、管理、资金分配 |
| IvyToken | IVY 代币 (BEP-20)、铸造、销毁 |
| GenesisNode | Genesis Node NFT、加成计算、权益管理 |
| Treasury | 资金池管理、RWA 资产对接 |
| Referral | 推荐关系、奖励计算、防作弊 |
| DAO | 提案、投票、执行 |
| Oracle | IVY 价格喂价、外部数据接入 |

### 8.2 合约交互流程图

**存款流程：**

```
用户                 IvyBond              IvyCore           Treasury
 │                     │                     │                  │
 │── approve USDT ────►│                     │                  │
 │                     │                     │                  │
 │── deposit() ───────►│                     │                  │
 │                     │── 分配资金 ─────────┼────────────────►│
 │                     │   50% → IvyCore     │                  │
 │                     │   40% → RWA         │                  │
 │                     │   10% → Reserve     │                  │
 │                     │                     │                  │
 │                     │── syncUser() ──────►│                  │
 │                     │                     │── 更新算力       │
 │                     │                     │                  │
 │◄── Bond NFT ────────│                     │                  │
 │                     │                     │                  │
```

**领取收益流程：**

```
用户                 IvyCore              IvyToken
 │                     │                     │
 │── harvest() ───────►│                     │
 │                     │── 计算 vIVY         │
 │                     │── 转入锁仓          │
 │                     │                     │
 │── claimVested() ───►│                     │
 │                     │── 检查释放量        │
 │                     │── mint() ──────────►│
 │                     │                     │── transfer IVY
 │◄────────────────────┼─────────────────────│
 │                     │                     │
```

### 8.3 关键函数说明

**IvyBond 合约：**

```solidity
// 存款铸造 Bond NFT
function deposit(uint256 amount, address referrer) external;

// 获取用户资金分配
function getFundAllocation(address user) external view returns (
    uint256 totalDeposited,
    uint256 redeemablePrincipal,  // 40% RWA
    uint256 miningPower,          // 50% Mining
    uint256 donatedAmount         // 10% Reserve
);

// 获取用户所有 Bond ID
function getUserBondIds(address user) external view returns (uint256[] memory);
```

**IvyCore 合约：**

```solidity
// 领取挖矿收益 (vIVY → 锁仓 IVY)
function harvest() external;

// 部分领取
function harvestPartial(uint256 amount) external;

// 复投至 Bond NFT
function compoundVestedPartial(uint256 bondId, uint256 amount) external;

// 领取已释放 IVY (30天后)
function claimVested() external;

// 即时提取 (50% 罚没)
function instantCashOut() external;

// 同步用户算力
function syncUser(address user) external;

// 获取用户挖矿状态
function getUserMiningStats(address user) external view returns (
    uint256 bondPower,
    uint256 pendingRewards,
    uint256 totalVested,
    uint256 totalClaimed,
    uint256 claimableNow
);

// 获取协议状态
function getProtocolStats() external view returns (
    uint256 totalMinted,
    uint256 hardCap,
    uint256 emissionFactor,
    uint256 pidMultiplier,
    uint256 totalPoolBondPower,
    uint256 emissionPerSecond
);
```

**GenesisNode 合约：**

```solidity
// 铸造 Genesis Node
function mint(address to, address referrer) external;

// 获取用户加成
function getTotalBoost(address user) external view returns (uint256);

// 获取用户信息
function getUserInfo(address user) external view returns (
    uint256 nodeCount,
    uint256 totalDeposits,
    uint256 directReferrals,
    uint256 selfBoostBps,
    uint256 teamAuraBps
);
```

### 8.4 安全审计报告

IVY Protocol 智能合约已通过专业安全机构审计。

**审计范围：**
- 智能合约代码审查
- 业务逻辑验证
- 权限控制检查
- 重入攻击防护
- 整数溢出检测
- 闪电贷攻击分析

**审计结论：**
- 严重漏洞：0
- 高危漏洞：0
- 中危漏洞：0
- 低危建议：已全部修复

*完整审计报告将在主网上线前公开发布。*

---

## 9. 风险控制

### 9.1 Circuit Breaker 熔断机制

IVY Protocol 内置三级熔断机制，在极端市场情况下保护协议和用户。

**熔断等级：**

| 等级 | 触发条件 | 响应措施 |
|------|----------|----------|
| Level 1 (黄色) | IVY 价格 24h 跌幅 > 20% | 释放量减少 30% |
| Level 2 (橙色) | IVY 价格 24h 跌幅 > 40% | 释放量减少 60%，暂停即时提取 |
| Level 3 (红色) | IVY 价格 24h 跌幅 > 60% | 暂停所有释放，仅允许提取已解锁代币 |

**熔断恢复：**
- 价格恢复至触发价的 80% 以上
- 持续稳定 24 小时
- 自动降级至更低熔断等级

### 9.2 储备金应急机制

Tranche C (10% 储备金) 可用于以下应急情况：

1. **流动性支撑**
   - 在极端市场下提供流动性
   - 防止 IVY 价格螺旋下跌

2. **漏洞赔付**
   - 如发生安全事故，优先赔付用户损失
   - 赔付方案需 DAO 投票通过

3. **协议维护**
   - 支付审计、运维等必要费用
   - 保障协议长期运行

**使用流程：**
```
紧急情况发生
      ↓
团队/DAO 发起紧急提案
      ↓
加速投票 (24小时)
      ↓
70% 以上通过
      ↓
执行动用储备金
      ↓
事后向社区披露明细
```

### 9.3 Oracle 价格保护

IVY Protocol 使用 Chainlink 预言机获取 IVY 价格，并实施以下保护措施：

1. **多源价格验证**
   - 同时读取多个 DEX 价格
   - 与 Chainlink 喂价交叉验证
   - 偏差超过 5% 时采用中位数

2. **价格更新频率**
   - 正常情况：每 10 分钟更新
   - 波动剧烈时：每 1 分钟更新

3. **异常价格过滤**
   - 单次价格变动超过 30% 时触发警报
   - 需人工确认后方可生效

### 9.4 智能合约风险

**已知风险及应对：**

| 风险类型 | 应对措施 |
|----------|----------|
| 合约漏洞 | 专业审计 + Bug Bounty 计划 |
| 管理员密钥泄露 | 多签钱包 (3/5) |
| 升级风险 | 时间锁 + DAO 投票 |
| 预言机操纵 | 多源验证 + 异常过滤 |
| 闪电贷攻击 | 单块交易限制 + 延迟结算 |

**Bug Bounty 计划：**
- 严重漏洞：最高 $100,000
- 高危漏洞：最高 $50,000
- 中危漏洞：最高 $10,000
- 低危漏洞：最高 $1,000

---

## 10. 技术实现

### 10.1 技术栈

**前端：**

| 技术 | 版本 | 用途 |
|------|------|------|
| React | 19 | UI 框架 |
| TypeScript | 5.x | 类型安全 |
| Vite | 7 | 构建工具 |
| Tailwind CSS | 4 | 样式框架 |
| Framer Motion | - | 动画效果 |
| TanStack Query | - | 状态管理 |

**Web3：**

| 技术 | 版本 | 用途 |
|------|------|------|
| wagmi | 3 | React Hooks |
| viem | 2 | 链上交互 |
| RainbowKit | - | 钱包连接 |

**智能合约：**

| 技术 | 版本 | 用途 |
|------|------|------|
| Solidity | 0.8.20 | 合约语言 |
| OpenZeppelin | 5.x | 安全组件 |
| Hardhat | - | 开发框架 |

### 10.2 链上架构 (BSC)

IVY Protocol 部署于 BNB Smart Chain (BSC)，选择理由：

1. **低 Gas 费用**：平均交易费用 < $0.1
2. **高 TPS**：支持每秒数千笔交易
3. **EVM 兼容**：便于合约开发和工具复用
4. **成熟生态**：丰富的 DeFi 基础设施

**网络信息：**

| 参数 | 主网 | 测试网 |
|------|------|--------|
| Chain ID | 56 | 97 |
| 原生代币 | BNB | tBNB |
| 区块时间 | ~3秒 | ~3秒 |
| RPC | 公开节点 | 公开节点 |

### 10.3 前端架构

**架构设计：**

```
┌─────────────────────────────────────────────────────────┐
│                     前端架构                             │
├─────────────────────────────────────────────────────────┤
│  Pages (页面层)                                          │
│  ├── Home      首页                                     │
│  ├── Nodes     节点控制台                                │
│  ├── Yield     收益终端                                  │
│  ├── Team      团队业绩                                  │
│  ├── Market    NFT 市场                                  │
│  └── DAO       治理中心                                  │
├─────────────────────────────────────────────────────────┤
│  Components (组件层)                                     │
│  ├── ui/       基础组件 (Button, Card, Input...)        │
│  ├── dao/      DAO 组件                                 │
│  └── ...       业务组件                                  │
├─────────────────────────────────────────────────────────┤
│  Hooks (逻辑层)                                          │
│  ├── useIvyContract    合约交互                          │
│  ├── useDAO            DAO 逻辑                         │
│  ├── useNFTMarket      市场逻辑                          │
│  └── ...                                                │
├─────────────────────────────────────────────────────────┤
│  Contexts (状态层)                                       │
│  ├── Web3Context       钱包连接                          │
│  ├── LanguageContext   多语言                           │
│  └── ReferralContext   推荐系统                          │
├─────────────────────────────────────────────────────────┤
│  Web3 (链上交互)                                         │
│  wagmi + viem + RainbowKit                              │
└─────────────────────────────────────────────────────────┘
```

**多语言支持：**
- English
- 繁體中文
- 한국어
- Español

### 10.4 安全措施

**前端安全：**
- 输入验证与 XSS 防护
- 地址格式校验 (viem isAddress)
- 敏感操作二次确认
- 错误监控 (Sentry)

**合约安全：**
- OpenZeppelin 安全组件
- 重入锁 (ReentrancyGuard)
- 访问控制 (Ownable, AccessControl)
- 暂停功能 (Pausable)

**运维安全：**
- 多签管理 (Gnosis Safe)
- 时间锁延迟执行
- 监控告警系统
- 定期安全检查

---

## 11. 路线图

### 2026 Q1: 测试网与审计

- [x] 核心合约开发完成
- [x] 前端 DApp 开发完成
- [x] BSC 测试网部署
- [ ] 内部测试与 Bug 修复
- [ ] 智能合约安全审计
- [ ] 社区公测

### 2026 Q2: 主网上线

- [ ] BSC 主网部署
- [ ] IVY Token TGE
- [ ] Genesis Node 公售
- [ ] 正式上线运营
- [ ] DEX 流动性池建立
- [ ] CoinMarketCap / CoinGecko 上线

### 2026 Q2: 生态扩展

- [ ] RWA 资产对接完成
- [ ] Chainlink Oracle 集成
- [ ] 合作伙伴拓展
- [ ] 社区增长计划
- [ ] 多语言本地化完善

### 2026 Q2: 跨链部署

- [ ] Ethereum 主网部署
- [ ] Arbitrum 部署
- [ ] 跨链桥集成
- [ ] 统一流动性方案

---

## 12. 法律声明

### 免责声明

本白皮书仅供参考，不构成任何投资建议、财务建议或其他专业建议。

1. **信息准确性**：本白皮书中的信息基于撰写时的现有情况，可能随时变更，恕不另行通知。

2. **前瞻性陈述**：本白皮书包含前瞻性陈述，涉及已知和未知风险、不确定性及其他因素，可能导致实际结果与预期存在重大差异。

3. **投资风险**：加密货币和 DeFi 协议具有高度风险，包括但不限于市场风险、技术风险、监管风险。参与者应自行承担全部风险。

4. **合规要求**：本协议不面向任何禁止加密货币交易的司法管辖区居民。用户有责任确保其参与符合当地法律法规。

5. **无担保**：IVY Protocol 团队不对协议的盈利能力、代币价值或任何特定结果作出担保。

### 知识产权

本白皮书及 IVY Protocol 相关的所有知识产权归 IVY Protocol 团队所有。未经书面许可，不得复制、分发或用于商业目的。

---

## 13. 附录

### A. 核心参数参考

**代币经济参数：**

| 参数 | 数值 | 说明 |
|------|------|------|
| 总供应量 | 100,000,000 IVY | 硬顶上限 |
| Pre-mint | 15,000,000 IVY (15%) | 部署时铸造 |
| Mining | 70,000,000 IVY (70%) | PID 控制释放 |
| LP Reserve | 15,000,000 IVY (15%) | 四阶段渐进式 |
| 基础日释放量 | 30,000 IVY | PID 调节后变化 |
| PID 乘数范围 | 0.1x - 1.5x | 根据价格/MA30 |
| 减半周期 | 每 7M IVY | 释放量 ×0.95 |
| 21M 黄金枢轴 | 21,000,000 IVY | 停止销毁，转为分红 |

**Genesis Node 参数：**

| 参数 | 数值 | 说明 |
|------|------|------|
| 价格 | 1,000 USDT | 固定价格 |
| 初始供应量 | 1,386 个 | 暂定数量 |
| 硬顶上限 | 1,727 个 | 最大供应量 |
| Self Boost | +10% | 持有者自身加成 |
| Team Aura | +2% | 直推用户加成 |
| DAO 投票权 | 1 Node = 1 Vote | 治理权重 |

**LP Reserve 四阶段分配：**

| 阶段 | 储备使用量 | 储备铸造 | 市场购买 | 名称 |
|------|------------|----------|----------|------|
| Stage 1 | 0 - 5M | 80% | 20% | Foundation |
| Stage 2 | 5M - 10M | 50% | 50% | Acceleration |
| Stage 3 | 10M - 15M | 20% | 80% | Sprint |
| Stage 4 | > 15M | 0% | 100% | Mature |

**推荐奖励参数：**

| 层级 | 比例 | 说明 |
|------|------|------|
| L1 直推 | 10% | 直接推荐人 |
| L2 间推 | 5% | 推荐人的推荐人 |
| Team Bonus | 2% | 第一个 Genesis Node 持有者 |
| Peer Bonus | 0.5% | Team Leader 的上级 |
| 最大搜索深度 | 20 层 | Gas 保护 |

**费率参数：**

| 费率类型 | 比例 | 用途 |
|----------|------|------|
| 转账税 | 0.2% | 0.1% 销毁 + 0.1% 运营 |
| 赎回费 | 2% | 协议收入 |
| 即时提取罚没 | 50% | 销毁至 0xdead |
| LP 交易费 | 0.3% | Uniswap 标准 |

**时间参数：**

| 参数 | 数值 |
|------|------|
| Bond 锁仓期 | 180 天 |
| 赎回清算期 | 7 天 |
| vIVY 释放期 | 30 天线性 |
| 熔断冷却期 | 4h / 12h / 24h |

### B. 合约地址 (BSC Mainnet)

*主网上线后更新*

| 合约 | 地址 |
|------|------|
| IvyToken | TBD |
| IvyCore | TBD |
| IvyBond | TBD |
| GenesisNode | TBD |
| LPManager | TBD |
| Treasury | TBD |

### C. 术语表

| 术语 | 定义 |
|------|------|
| Bond NFT | 代表用户在协议中持仓权益的 ERC-721 代币 |
| Genesis Node | IVY Protocol 核心会员权益凭证 NFT |
| vIVY | 虚拟 IVY，挖矿产出的中间态代币 |
| Harvest | 将 vIVY 转换为锁仓 IVY 的操作 |
| Compound | 将收益复投增加算力的操作 |
| PID Controller | 比例-积分-微分控制器，用于动态调节释放 |
| RWA | Real World Assets，真实世界资产 |
| Tranche | 分层资金池 |
| Circuit Breaker | 熔断机制 |

### C. 参考资料

1. BNB Smart Chain Documentation
2. OpenZeppelin Contracts
3. Chainlink Price Feeds
4. ERC-721 Standard
5. ERC-20 Standard

---

**Document Version:** 1.1
**Last Updated:** January 2026
**Contact:** [官方渠道待补充]

---

*IVY Protocol - Structured Yield, Sustainable Growth*
